<!DOCTYPE html>
<html class="dark" lang="pt">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" name="viewport"/>
<title>Darkwave Player - Ultimate</title>
<script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
<link href="https://fonts.googleapis.com/css2?family=Spline+Sans:wght@400;500;700&display=swap" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:opsz,wght,FILL,GRAD@24,400,1,0" rel="stylesheet"/>

<script id="tailwind-config">
    tailwind.config = {
      darkMode: "class",
      theme: {
        extend: {
          colors: {
            "background-dark": "#050005",
            "card-dark": "#120012",
          },
          fontFamily: {
            "display": ["Spline Sans", "sans-serif"]
          },
          animation: {
            'vibrate': 'vibrate 0.3s linear infinite',
          }
        },
      },
    }
</script>

<style>
    :root {
        --neon-primary: #9d00ff;
        --neon-secondary: #ff004c;
    }

    body {
        background-color: #000;
        overflow-x: hidden; 
        touch-action: pan-y;
        user-select: none;
        -webkit-tap-highlight-color: transparent;
    }

    /* --- EFEITOS DE CORES --- */
    @keyframes rainbow-border {
        0% { border-color: #9d00ff; box-shadow: 0 0 10px #9d00ff; }
        25% { border-color: #ff004c; box-shadow: 0 0 10px #ff004c; }
        50% { border-color: #ffff00; box-shadow: 0 0 10px #ffff00; }
        75% { border-color: #00eaff; box-shadow: 0 0 10px #00eaff; }
        100% { border-color: #9d00ff; box-shadow: 0 0 10px #9d00ff; }
    }

    .btn-frenetic:active {
        animation: rainbow-border 0.2s infinite;
        transform: scale(0.95);
    }

    /* --- BARRA CARDÍACA (Pulsar) --- */
    @keyframes heartbeat-bar {
        0% { height: 100%; opacity: 0.8; background: var(--neon-primary); }
        20% { height: 60%; opacity: 0.6; background: #ffff00; } /* Amarelo */
        40% { height: 120%; opacity: 1; background: #ff0000; box-shadow: 0 0 20px #ff0000; } /* Vermelho Explosão */
        60% { height: 50%; opacity: 0.7; background: #00eaff; } /* Azul */
        80% { height: 90%; opacity: 0.9; background: var(--neon-secondary); }
        100% { height: 100%; opacity: 0.8; background: var(--neon-primary); }
    }

    .heartbeat-container {
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 2px;
        height: 100%;
        width: 100%;
        overflow: hidden;
    }

    .heartbeat-bar {
        width: 100%;
        height: 100%;
        background: var(--neon-primary);
        transform-origin: bottom;
    }

    .is-playing .heartbeat-bar {
        animation: heartbeat-bar 0.5s infinite ease-in-out alternate;
    }

    /* Variações de tempo para parecer aleatório */
    .is-playing .heartbeat-bar:nth-child(odd) { animation-duration: 0.4s; }
    .is-playing .heartbeat-bar:nth-child(even) { animation-duration: 0.6s; }
    .is-playing .heartbeat-bar:nth-child(3n) { animation-duration: 0.3s; }

    /* --- MODO PÂNICO --- */
    @keyframes shake-screen {
        0% { transform: translate(1px, 1px) rotate(0deg); }
        10% { transform: translate(-1px, -2px) rotate(-1deg); }
        20% { transform: translate(-3px, 0px) rotate(1deg); }
        30% { transform: translate(3px, 2px) rotate(0deg); }
        40% { transform: translate(1px, -1px) rotate(1deg); }
        50% { transform: translate(-1px, 2px) rotate(-1deg); }
        60% { transform: translate(-3px, 1px) rotate(0deg); }
        70% { transform: translate(3px, 1px) rotate(-1deg); }
        80% { transform: translate(-1px, -1px) rotate(1deg); }
        90% { transform: translate(1px, 2px) rotate(0deg); }
        100% { transform: translate(1px, -2px) rotate(-1deg); }
    }

    .panic-active {
        animation: shake-screen 0.1s infinite !important;
        filter: invert(1) hue-rotate(180deg) contrast(200%);
    }

    /* Scrollbar */
    ::-webkit-scrollbar { width: 4px; }
    ::-webkit-scrollbar-track { background: #111; }
    ::-webkit-scrollbar-thumb { background: #444; border-radius: 2px; }
</style>
<script src="https://www.youtube.com/iframe_api"></script>
</head>

<body class="bg-background-dark font-display text-gray-200 h-screen flex flex-col">

    <header class="sticky top-0 z-30 bg-black/90 backdrop-blur-md border-b border-white/10 shrink-0">
        <div class="flex items-center justify-between p-4">
            <button class="btn-frenetic rounded-full p-2 text-white/80 hover:bg-white/10 hover:text-white transition-all">
                <span class="material-symbols-rounded text-2xl">menu</span>
            </button>
            
            <h1 class="text-xl font-bold tracking-[0.3em] uppercase text-transparent bg-clip-text bg-gradient-to-r from-purple-500 via-red-500 to-yellow-500 animate-pulse">
                Darkwave
            </h1>
            
            <button onclick="triggerPanic()" class="btn-frenetic group relative flex items-center justify-center p-2 rounded-full border border-red-900 bg-red-900/20 shadow-[0_0_15px_rgba(255,0,0,0.4)]">
                <span class="material-symbols-rounded text-red-500 animate-pulse">warning</span>
            </button>
        </div>

        <nav class="flex text-sm font-medium tracking-wide">
            <button onclick="switchTab('tracks')" id="tab-tracks" class="flex-1 py-3 text-center border-b-2 border-purple-600 text-purple-400 bg-white/5">FAIXAS</button>
            <button onclick="switchTab('playlist')" id="tab-playlist" class="flex-1 py-3 text-center border-b-2 border-transparent text-gray-500 hover:text-gray-300">MY LIST</button>
            <button onclick="switchTab('artists')" id="tab-artists" class="flex-1 py-3 text-center border-b-2 border-transparent text-gray-500 hover:text-gray-300">ARTISTAS</button>
        </nav>
    </header>

    <main class="flex-1 overflow-y-auto pb-40 relative">
        
        <div id="view-tracks" class="p-3 space-y-3">
            <button onclick="playAll()" class="btn-frenetic w-full py-4 rounded-xl bg-gradient-to-r from-purple-900 to-red-900 border border-white/10 shadow-lg flex items-center justify-center gap-2 group mb-4">
                <span class="material-symbols-rounded text-3xl group-hover:scale-125 transition-transform">play_circle</span>
                <span class="text-lg font-bold tracking-widest">TOCAR TUDO</span>
            </button>

            <div id="list-tracks" class="flex flex-col gap-2"></div>
        </div>

        <div id="view-playlist" class="hidden p-3 space-y-3">
            <div id="list-playlist" class="flex flex-col gap-2">
                <div class="text-center py-10 text-gray-600 uppercase tracking-widest text-xs">
                    Sua setlist está vazia.<br>Adicione músicas na aba Faixas.
                </div>
            </div>
        </div>

        <div id="view-artists" class="hidden p-3">
            <div id="grid-artists" class="grid grid-cols-2 gap-3"></div>
        </div>

    </main>

    <footer id="player-footer" class="fixed bottom-0 w-full z-40 bg-black/95 backdrop-blur-xl border-t border-white/10 shadow-[0_-5px_30px_rgba(0,0,0,1)]">
        
        <div class="relative h-2 w-full bg-gray-900 overflow-hidden">
            <div class="heartbeat-container opacity-50">
                <div class="heartbeat-bar w-full"></div>
            </div>
            <div id="progress-fill" class="absolute top-0 left-0 h-full bg-gradient-to-r from-purple-500 via-red-500 to-yellow-400 opacity-80" style="width: 0%"></div>
        </div>

        <div class="flex items-center gap-3 p-3 pb-6"> <div class="relative h-16 w-16 shrink-0 rounded-md overflow-hidden bg-gray-800 shadow-lg border border-white/10">
                <div id="player-art" class="absolute inset-0 bg-cover bg-center transition-opacity" style="background-image: url('');"></div>
                <div id="yt-player" class="absolute inset-0 opacity-0 pointer-events-none"></div>
            </div>

            <div class="flex-1 min-w-0 overflow-hidden">
                <div class="flex flex-col">
                    <p id="track-title" class="truncate text-sm font-bold text-white leading-tight">Gallowdance</p>
                    <p id="track-artist" class="truncate text-xs text-purple-400 font-medium">Lebanon Hanover</p>
                </div>
            </div>

            <div class="flex items-center gap-1">
                <button onclick="prevSong()" class="btn-frenetic p-2 text-gray-400 hover:text-white rounded-full">
                    <span class="material-symbols-rounded text-2xl">skip_previous</span>
                </button>
                
                <button onclick="togglePlay()" id="btn-play" class="btn-frenetic flex h-12 w-12 items-center justify-center rounded-full bg-white text-black hover:scale-110 transition-transform shadow-[0_0_15px_rgba(255,255,255,0.3)]">
                    <span class="material-symbols-rounded text-3xl">play_arrow</span>
                </button>
                
                <button onclick="nextSong()" class="btn-frenetic p-2 text-gray-400 hover:text-white rounded-full">
                    <span class="material-symbols-rounded text-2xl">skip_next</span>
                </button>
            </div>
        </div>
    </footer>

    <div id="click-effect" class="pointer-events-none fixed inset-0 z-50 opacity-0 bg-red-500/20 mix-blend-overlay transition-opacity duration-100"></div>

<script>
    // --- BANCO DE DADOS ---
    const allSongs = [
        { id: "-HeCgOiirV4", artist: "Lebanon Hanover", title: "Gallowdance" },
        { id: "tBpQ1f77PDA", artist: "She Past Away", title: "Kasvetli Kutlama" },
        { id: "h4Jnv-pb6sk", artist: "Boy Harsher", title: "Pain" },
        { id: "A_ZJnKoMoBA", artist: "Molchat Doma", title: "Sudno" },
        { id: "9CvpeDHgCpo", artist: "The Cure", title: "A Forest" },
        { id: "LHUz8vA_wCM", artist: "Joy Division", title: "Disorder" },
        { id: "bIGoN8_vv_Y", artist: "Bauhaus", title: "Bela Lugosi's Dead" },
        { id: "npQwX2X3WBE", artist: "Siouxsie and the Banshees", title: "Spellbound" },
        { id: "qLQ0PZ-Zwc8", artist: "Sisters of Mercy", title: "Lucretia My Reflection" },
        { id: "bjxfcGJM3V4", artist: "Clan of Xymox", title: "Jasmine and Rose" },
        { id: "DOzdBjtA9H0", artist: "London After Midnight", title: "Sacrifice" },
        { id: "qFtiH1bZuJ0", artist: "Drab Majesty", title: "Ellipsis" },
        { id: "FaHMRB30HmA", artist: "Twin Tribes", title: "Fantasmas" },
        { id: "VdAlPCrndT8", artist: "Selofan", title: "Give Me A Reason" },
        { id: "gebchYvcp2s", artist: "Kælan Mikla", title: "Draumadís" },
        { id: "77GxLUUEcHo", artist: "TR/ST", title: "Sulk" },
        { id: "bYM8iPn47yE", artist: "Mareux", title: "The Perfect Girl" },
        { id: "bpxKOOUhLs8", artist: "Crystal Castles", title: "Transgender" },
        { id: "y0AaKrZLFQo", artist: "Pastel Ghost", title: "Dark Beach" },
        { id: "LVQi3iyx_Hc", artist: "Sidewalks and Skeletons", title: "Goth" },
        { id: "ElcwzDwdYkA", artist: "Mr.Kitty", title: "After Dark" },
        { id: "F3VwhAe7Ks0", artist: "Depeche Mode", title: "Enjoy The Silence" },
        { id: "mwooX2qXrwE", artist: "The KVB", title: "Always Then" },
        { id: "lAt6qFZby5w", artist: "Cold Cave", title: "Confetti" },
        { id: "Wj1r0bU3pkg", artist: "Soft Kill", title: "Whirl" },
        { id: "5zS9CbU1gxY", artist: "Choir Boy", title: "Complainer" },
        { id: "pO4lvJUwrwk", artist: "Black Marble", title: "A Great Design" },
        { id: "X8wAX8uZHi8", artist: "Human Tetris", title: "Things I Don't Need" },
        { id: "4AcNJQYb0Rw", artist: "Motorama", title: "Alps" },
        { id: "6170iawsQHE", artist: "Soviet Soviet", title: "Ecstasy" }
    ];

    let myPlaylist = [];
    let player;
    let currentContext = 'all'; // 'all' ou 'playlist'
    let currentIndex = 0;
    let isPlaying = false;
    let autoPlay = false;

    // --- SETUP INICIAL ---
    function onYouTubeIframeAPIReady() {
        player = new YT.Player('yt-player', {
            height: '100%',
            width: '100%',
            videoId: allSongs[0].id,
            playerVars: { 'playsinline': 1, 'controls': 0, 'rel': 0 },
            events: {
                'onStateChange': onPlayerStateChange,
                'onReady': () => updatePlayerUI(allSongs[0])
            }
        });
    }

    function onPlayerStateChange(event) {
        if (event.data == YT.PlayerState.PLAYING) {
            isPlaying = true;
            document.getElementById('player-footer').classList.add('is-playing');
            document.querySelector('#btn-play span').innerText = 'pause';
            startProgressLoop();
        } else {
            isPlaying = false;
            document.getElementById('player-footer').classList.remove('is-playing');
            document.querySelector('#btn-play span').innerText = 'play_arrow';
            if (event.data == YT.PlayerState.ENDED && autoPlay) {
                nextSong();
            }
        }
    }

    // --- CONTROLE DE MÚSICA ---
    function loadSong(index, context = 'all') {
        currentContext = context;
        let list = context === 'all' ? allSongs : myPlaylist;
        
        if (list.length === 0) return;
        
        // Garante loop seguro
        if (index >= list.length) index = 0;
        if (index < 0) index = list.length - 1;
        
        currentIndex = index;
        const song = list[currentIndex];

        player.loadVideoById(song.id);
        updatePlayerUI(song);
        flashScreen(); // Efeito visual de troca
    }

    function togglePlay() {
        if (!player) return;
        if (isPlaying) player.pauseVideo();
        else player.playVideo();
    }

    function nextSong() {
        loadSong(currentIndex + 1, currentContext);
    }

    function prevSong() {
        loadSong(currentIndex - 1, currentContext);
    }

    function playAll() {
        autoPlay = true;
        loadSong(0, 'all');
        alert("AUTO-DJ ATIVADO: Tocando todas as faixas em sequência.");
    }

    function updatePlayerUI(song) {
        document.getElementById('track-title').innerText = song.title;
        document.getElementById('track-artist').innerText = song.artist;
        document.getElementById('player-art').style.backgroundImage = `url('https://img.youtube.com/vi/${song.id}/mqdefault.jpg')`;
        
        // Atualiza a barra de "batida" para ser mais caótica
        const bars = document.querySelectorAll('.heartbeat-bar');
        bars.forEach(bar => {
            bar.style.backgroundColor = getRandomColor();
        });
    }

    // --- GESTÃO DE PLAYLIST E UI ---
    function renderLists() {
        // Lista Principal
        const listTracks = document.getElementById('list-tracks');
        listTracks.innerHTML = allSongs.map((song, i) => createTrackItem(song, i, 'all')).join('');

        // Lista Pessoal
        const listPlaylist = document.getElementById('list-playlist');
        if (myPlaylist.length > 0) {
            listPlaylist.innerHTML = myPlaylist.map((song, i) => createTrackItem(song, i, 'playlist')).join('');
        } else {
            listPlaylist.innerHTML = `<div class="text-center py-10 text-gray-600 uppercase text-xs tracking-widest">Vazio</div>`;
        }

        // Grade de Artistas
        const gridArtists = document.getElementById('grid-artists');
        const uniqueArtists = [...new Set(allSongs.map(s => s.artist))];
        gridArtists.innerHTML = uniqueArtists.map(artist => {
            // Acha uma música desse artista para pegar a foto
            const song = allSongs.find(s => s.artist === artist);
            return `
                <div class="relative aspect-square rounded-lg overflow-hidden border border-white/10 group">
                    <img src="https://img.youtube.com/vi/${song.id}/hqdefault.jpg" class="w-full h-full object-cover grayscale group-hover:grayscale-0 transition-all duration-500">
                    <div class="absolute inset-0 bg-black/60 flex items-end p-2">
                        <span class="text-xs font-bold text-white truncate w-full">${artist}</span>
                    </div>
                </div>
            `;
        }).join('');
    }

    function createTrackItem(song, index, context) {
        const isMyList = context === 'playlist';
        const actionBtn = isMyList 
            ? `<button onclick="removeFromPlaylist(${index}, event)" class="p-2 text-red-500 hover:text-red-300"><span class="material-symbols-rounded">remove_circle</span></button>`
            : `<button onclick="addToPlaylist(${index}, event)" class="p-2 text-gray-500 hover:text-green-400"><span class="material-symbols-rounded">add_circle</span></button>`;

        return `
            <div onclick="loadSong(${index}, '${context}')" class="btn-frenetic flex items-center gap-3 p-2 rounded-lg bg-white/5 border border-transparent hover:border-white/20 cursor-pointer transition-all">
                <img src="https://img.youtube.com/vi/${song.id}/default.jpg" class="h-10 w-10 rounded object-cover opacity-70">
                <div class="flex-1 min-w-0">
                    <p class="text-sm font-bold text-gray-200 truncate">${song.title}</p>
                    <p class="text-[10px] text-gray-400 uppercase tracking-wider truncate">${song.artist}</p>
                </div>
                ${actionBtn}
            </div>
        `;
    }

    function addToPlaylist(index, event) {
        event.stopPropagation();
        const song = allSongs[index];
        if (!myPlaylist.some(s => s.id === song.id)) {
            myPlaylist.push(song);
            renderLists();
            alert(`"${song.title}" adicionada à sua Playlist!`);
        }
    }

    function removeFromPlaylist(index, event) {
        event.stopPropagation();
        myPlaylist.splice(index, 1);
        renderLists();
    }

    // --- NAVEGAÇÃO ---
    function switchTab(tab) {
        ['tracks', 'playlist', 'artists'].forEach(t => {
            document.getElementById(`tab-${t}`).classList.remove('border-purple-600', 'text-purple-400', 'bg-white/5');
            document.getElementById(`tab-${t}`).classList.add('border-transparent', 'text-gray-500');
            document.getElementById(`view-${t}`).classList.add('hidden');
        });
        
        const activeBtn = document.getElementById(`tab-${tab}`);
        activeBtn.classList.remove('border-transparent', 'text-gray-500');
        activeBtn.classList.add('border-purple-600', 'text-purple-400', 'bg-white/5');
        document.getElementById(`view-${tab}`).classList.remove('hidden');
    }

    // --- EFEITOS VISUAIS E UTILITÁRIOS ---
    function getRandomColor() {
        const colors = ['#9d00ff', '#ff004c', '#ffff00', '#00eaff', '#ff0000'];
        return colors[Math.floor(Math.random() * colors.length)];
    }

    function startProgressLoop() {
        if (!player || !isPlaying) return;
        const duration = player.getDuration();
        const currentTime = player.getCurrentTime();
        if (duration > 0) {
            const pct = (currentTime / duration) * 100;
            document.getElementById('progress-fill').style.width = pct + '%';
        }
        requestAnimationFrame(startProgressLoop);
    }

    function flashScreen() {
        const overlay = document.getElementById('click-effect');
        overlay.style.backgroundColor = getRandomColor();
        overlay.style.opacity = '0.3';
        setTimeout(() => overlay.style.opacity = '0', 150);
    }

    function triggerPanic() {
        document.body.classList.toggle('panic-active');
        if (isPlaying) togglePlay();
    }

    // Inicialização
    renderLists();
</script>
</body>
</html>
